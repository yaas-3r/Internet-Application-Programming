<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Secure Login System</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="auth-container">
    <h2>Welcome</h2>
    <div class="auth-footer">Â© 2025 Group Project</div>
    <div class="auth-toggle">
      <button id="showLogin" class="active">Log In</button>
      <button id="showSignup">Sign Up</button>
    </div>

    <!-- LOGIN FORM -->
    <form id="loginForm" class="auth-form" onsubmit="return validateForm('loginForm')">
      <h2>Log In</h2>
      <input type="email" id="loginEmail" placeholder="Email" required>
      <input type="password" id="loginPassword" placeholder="Password" required>
      <button type="submit">Send OTP</button>
    </form>

    <!-- SIGNUP FORM -->
    <form id="signupForm" class="auth-form hidden">
      <h2>Sign Up</h2>
      <input type="email" id="signupEmail" placeholder="Email" required>
      <input type="password" id="signupPassword" placeholder="Password" required>
      <button type="submit">Register</button>
    </form>

    <!-- OTP FORM -->
    <form id="otpForm" class="auth-form hidden">
      <h2>Enter OTP</h2>
      <input type="text" id="otpInput" placeholder="Enter OTP" required>
      <button type="submit">Verify OTP</button>
    </form>

    <!-- USERS LIST -->
    <div id="usersPage" class="hidden">
      <h2>Available Users</h2>
      <ul id="usersList"></ul>
    </div>
  </div>
  <button type="button" onclick="resendOtp()">Resend OTP</button>

  <script src="script.js"></script>
</body>
</html>













<script>
    const showLoginBtn = document.getElementById("showLogin");
const showSignupBtn = document.getElementById("showSignup");
const loginForm = document.getElementById("loginForm");
const signupForm = document.getElementById("signupForm");
const otpForm = document.getElementById("otpForm");
const usersPage = document.getElementById("usersPage");

let currentEmail = "";

// Toggle between Login and Signup
showLoginBtn.addEventListener("click", () => {
  showLoginBtn.classList.add("active");
  showSignupBtn.classList.remove("active");
  loginForm.classList.remove("hidden");
  signupForm.classList.add("hidden");
});

showSignupBtn.addEventListener("click", () => {
  showSignupBtn.classList.add("active");
  showLoginBtn.classList.remove("active");
  signupForm.classList.remove("hidden");
  loginForm.classList.add("hidden");
});

// Handle Signup
signupForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("signupEmail").value;
  const password = document.getElementById("signupPassword").value;

  const res = await fetch("http://localhost:3000/signup", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email, password })
  });

  const data = await res.json();
  alert(data.message);
});

// Handle Login (Send OTP)
loginForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("loginEmail").value;
  const password = document.getElementById("loginPassword").value;

  const res = await fetch("http://localhost:3000/auth", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email, password })
  });

  const data = await res.json();
  alert(data.message);

  if (res.ok) {
    currentEmail = email;
    loginForm.classList.add("hidden");
    otpForm.classList.remove("hidden");
  }
});

// Handle OTP Verification
otpForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const otp = document.getElementById("otpInput").value;

  const res = await fetch("http://localhost:3000/verify-otp", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email: currentEmail, otp })
  });

  const data = await res.json();
  alert(data.message);

  if (res.ok) {
    otpForm.classList.add("hidden");
    usersPage.classList.remove("hidden");

    // Load users
    const usersRes = await fetch("http://localhost:3000/users");
    const users = await usersRes.json();
    const usersList = document.getElementById("usersList");
    usersList.innerHTML = "";
    users.forEach(u => {
      const li = document.createElement("li");
      li.textContent = u.email;
      usersList.appendChild(li);
    });
  }
});
 // Simple validation for signup/login forms
  function validateForm(formId) {
    const form = document.getElementById(formId);
    const inputs = form.querySelectorAll("input[required]");
    let valid = true;

    inputs.forEach(input => {
      if (!input.value.trim()) {
        alert(`${input.placeholder || input.name} is required`);
        valid = false;
      }
    });

    return valid;
  }

  async function resendOtp() {
    const email = document.querySelector("#loginForm input[name='email']").value;
    if (!email) return alert("Enter your email first");

    const res = await fetch("/resend-otp", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email })
    });

    const data = await res.json();
    if (data.error) {
      alert("Error: " + data.error);
    } else {
      alert(data.message);
    }
  }

</script>